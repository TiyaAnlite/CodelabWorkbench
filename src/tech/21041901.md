---
title: UNRAID折腾笔记(5) - Windows虚拟机
date: 2021-04-19
category: 技术向
tag:
    - 技术研究
isOriginal: true
---

这一篇是Unraid折腾第一波的追加篇，你可能意识到其实之前讲过关于虚拟机配置的内容了([UNRAID折腾笔记(2) - 网卡直通与虚拟机](/tech/21040201))，但这一次是专为了讲Windows虚拟机需要的注意事项。

<!-- more -->

我选择的系统镜像是Windows10 LTSC，无应用时占用内存仅900M，相对于臃肿的win10而言已经相当轻量了，而且删减了UWP应用和应用商店，如果需要的话就要自行额外安装。 如果你用过VMware，可能在安装虚拟机操作系统时没有遇到什么驱动方面的问题，但是这个虚拟机是基于QUMU，这些虚拟化的硬件是需要额外安装驱动的，而不是像前面的装上就能直接免驱。这篇笔记着重围绕的就是这个问题展开。 首先准备好镜像并上传后第一步需要做的事，不是去创建虚拟机，而是要先到设置-虚拟机管理器中，找到默认Windows VirtIO驱动程序，下拉选择一个最新的即可，按下旁边的下载按钮开始下载，大小约400M，需要一些耐心等待。

> 当然，如果你觉得它提供的VirtIO的驱动版本不能满足要求，可以在[这里](https://fedorapeople.org/groups/virt/virtio-win/direct-downloads/archive-virtio/ "VirtIO-Win")找到最新的版本，其中的ISO版本就是这里用的到镜像，选择需要下载的版本，并放到相应位置并指定路径即可

该链接内也同时提供了下文会提到的驱动安装程序，可以自行选择取用

![](https://i.focotx.net/blog/2021/04/2021-04-16-200752.png)

然后开始创建虚拟机，按照自己的需求分配内存和CPU，可以点击每个CPU逻辑核心的小圆点来指定。最重要的是下面的虚拟硬盘，第一个自然是系统盘，第二个VirtIO驱动程序选择刚才下载的驱动包，总线保持默认IDE不用改

![](https://i.focotx.net/blog/2021/04/2021-04-16-200636.png)

接下来是其他的一些配置，自己根据需要配置即可

![](https://i.focotx.net/blog/2021/04/2021-04-16-200705.png)

然后开始启动虚拟机，马上连接VNC，启动时出现如下提示时，记得要及时按下任意键进入光驱引导，不然就等着一直卡在引导界面吧

![](https://i.focotx.net/blog/2021/04/2021-04-16-200938.png)

进入windows安装界面后，选择自定义安装，发现没有硬盘。此时不要着急，选择下方的加载驱动程序，找到挂载上去的驱动，选择amd64底下的w10，如果你是32位或者是其他win系统可以自行判断

![](https://i.focotx.net/blog/2021/04/2021-04-16-201123.png)

![](https://i.focotx.net/blog/2021/04/2021-04-16-201502.png)

![](https://i.focotx.net/blog/2021/04/2021-04-16-201543.png)

如果选择没有错误，那么就能看到这个虚拟驱动，安装后即可看到虚拟硬盘了

![](https://i.focotx.net/blog/2021/04/2021-04-16-201602.png)

![](https://i.focotx.net/blog/2021/04/2021-04-16-201638.png)

按正常流程安装windows，然后在系统首次配置时就会发现没有网卡，此时可以选择暂时先跳过，走完流程后来到windows桌面 进入资源管理器找到挂载的驱动盘，安装根目录下的virtio-win-gt-x64(当然如果选择是32位那就是x86)，安装完之后，就会发现网卡出现了

![](https://i.focotx.net/blog/2021/04/2021-04-16-201749.png)

![](https://i.focotx.net/blog/2021/04/2021-04-16-201819.png)

此时进入设备管理器，所有的设备应该都是正常运行的，没有缺失驱动的情况

![](https://i.focotx.net/blog/2021/04/2021-04-16-202135.png)

之后，还可以选择性安装底下的virtio-win-guest-tools，这个工具可以增强VNC客户端与虚拟机的交互，例如让鼠标显示更加友好，当时由于VNC界面是在web上的，所以无法像VMware的增强驱动那样可以同步剪贴板，需要这类功能需要借助其他远程桌面工具。 自此，windows虚拟机需要的注意事项就到这里了